(function(){define(["jquery"],function(){var t,e;return t=function(){function t(){this.navigateTo("#start",1),this.listen()}return t.prototype.interests=[],t.prototype.suggestions=[],t.prototype.randomInterest=function(){return this.interests[Math.floor(Math.random()*this.interests.length)]},t.prototype.listen=function(){var t=this;return $(".person").on("click",function(e){var n;return e.preventDefault(),n=$(e.currentTarget).attr("data-id"),t.fetchUserInterests(n)}),$("#load-more").on("click",function(e){return e.preventDefault(),t.loadMore()}),$(".gift-result .btn.buy").on("click",function(e){var n;return e.preventDefault(),n=$(e.currentTarget).attr("data-index"),t.packOrder(n)})},t.prototype.fetchUserInterests=function(t){var e=this;return $.getJSON("user/"+t+".json",function(t){return e.interests=t,e.navigateTo("#gifts"),e.suggestion_attempts=0,e.fetchSuggestions()})},t.prototype.fetchSuggestions=function(){var t=this;return 4>this.suggestion_attempts?$.getJSON("bol/suggestions/"+this.randomInterest()+".json",function(e){return t.suggestions=e,t.addSuggestions()}).fail(function(){return t.suggestion_attempts++,t.fetchSuggestions()}):alert("Sorry, we couldn't find any suggestions for this person.")},t.prototype.addSuggestions=function(){var t=this;return $(".gift-result").each(function(e,n){return $(n).find("h4").text(t.suggestions[e].attributes.title),$(n).find(".desc").text(t.suggestions[e].attributes.short_description),$(n).find("span.price").text("â‚¬ "+t.suggestions[e].attributes.offers[0].table.price),$(n).find(".gift-preview").css({"background-image":"url( "+t.suggestions[e].attributes.cover.extra_large+")"}),$(n).find(".btn.buy").attr("href",t.suggestions[e].attributes.url),$(n).find(".btn.buy").attr("data-index",e)}),$("#gifts").removeClass("loading")},t.prototype.loadMore=function(){return this.suggestion_attempts=0,$("#gifts").addClass("loading"),this.fetchSuggestions()},t.prototype.navigateTo=function(t,e){return null==e&&(e=500),$("body").animate({scrollTop:$(""+t).position().top},e)},t.prototype.packOrder=function(t){return this.navigateTo("#pack"),$("#the-gift").find("img").attr("src",this.suggestions[t].attributes.cover.extra_large),$("#actual-buy").attr("href",this.suggestions[t].attributes.url)},t}(),$(".person").length>0&&(e=new t),$('[data-type="connection-search"]').length>0&&$('[data-type="connection-search"]').on("keyup",function(t){var e;return e=$(t.currentTarget).val().toLowerCase(),""!==e?($("[data-name]").hide(),$('[data-name*="'+e+'"]').show()):$("[data-name]").show()}),$("i.icon-info").on("click",function(){return $(this).parent().toggleClass("open")}),$(".page").css({minHeight:$(window).height()}),$('[data-type="purchase"]').on("click",function(t){var e;return t.preventDefault(),e=$(this).attr("href"),$(".gift").addClass("send"),setTimeout(function(){return window.location=e},3600)})})}).call(this);